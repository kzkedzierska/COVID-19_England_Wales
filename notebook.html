---
title: "COVID-19 mortality in England and Wales"
subtitle: "Based on the ONS data"
author: Kasia Kedzierska
date: "2020-07-23"
output:
  html_document:
    df_print: paged
    code_folding: hide
    theme: paper
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
    toc_depth: 3
---



<div id="disclaimer" class="section level2">
<h2>Disclaimer</h2>
<p>As probably many of the data scientist, I wanted to ease my anxiety caused by the COVID-19. I decided to look at the data related to the pandemic. I decided not to look at the daily cases as <a href="https://twitter.com/jburnmurdoch">John Burn-Murdoch</a> from <a href="https://www.ft.com/coronavirus-latest">Financial Times</a> and the team <a href="https://ourworldindata.org/the-covid-19-pandemic-slide-deck">Our World in Data</a> are doing a great job. The reasons why I decided to look at deaths are explained in the Motivation section.</p>
<p>I am a <strong>computational biologist</strong> and all the plots I am making here are just <em>observations</em>. I am not claiming any conclusions, nor do I do any predictions. All the code is open source, and free for anyone to use, available on <a href="https://github.com/kzkedzierska/COVID-19_England_Wales">github</a>.</p>
<p>Also, very warm thanks to <a href="https://kasparmartens.rbind.io/">Kaspar</a> for his help with decisions regarding color schemes and his helpful advice.</p>
</div>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>I decided to look into the mortality rates because I wanted to put the numbers reported by the government in some context. My first question was whether the deaths reported as COVID-19 deaths were a subset of deaths one could expect to see this year? How much COVID-19 increases the death toll? And finally, how does the age distribution of fatalities look?</p>
<p>The data I plotted below shades a bit of light on those topics, but for a more in-depth answer, I am afraid we will have to wait for long. Nevertheless, I still think the following is quite interesting. If not for others, then for the sole reason of looking at the data in almost real-time.</p>
</div>
<div id="setup" class="section level2">
<h2>Setup</h2>
<p>Loading up the necessary packages (installing them if they are missing). Setting up defaults and tweaking the plotting defaults.</p>
<pre class="r"><code># Load packages
cran_pkgs &lt;- c(&quot;tidyverse&quot;, &quot;ggsci&quot;, &quot;patchwork&quot;, 
               &quot;readxl&quot;, &quot;knitr&quot;, &quot;ggforce&quot;, &quot;lubridate&quot;)
source(&quot;scripts/load_pkgs.R&quot;)
load_packages(cran_pkgs = cran_pkgs)</code></pre>
<pre><code>## [1] &quot;Success! All packages loaded!&quot;</code></pre>
<pre class="r"><code># Set defaults for plotting
theme_set(theme_bw() + theme(legend.position = &quot;bottom&quot;))

# Don&#39;t print warnings
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

# Update date of the data
data_up_to &lt;- ymd(&quot;2020-07-10&quot;)</code></pre>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>Data up to: 2020-07-10</p>
<p>Data is coming from <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/deaths/datasets/weeklyprovisionalfiguresondeathsregisteredinenglandandwales">Office for National Statistics, <em>Deaths registered weekly in England and Wales, provisional</em> dataset</a>. For now I am downloading the data manually into the <code>data</code> directory. It would be great to download it directly.</p>
<div id="weekly-figures" class="section level3">
<h3>Weekly figures</h3>
<p>Both 2020 and 2019 figures for comparison of the trend. The 2020 will be changed each week, while 2019 remains stable.</p>
<p><em>Note:</em> Unfortunately due to formatting of the data the following code is not entirely reproducible as there are parts of it that would have to be adjusted with each reiteration of the spreadsheet. In theory the code should be backward compatible, but I haven’t checked that in practice.</p>
<div id="baseline" class="section level4">
<h4>2019 baseline</h4>
<p>Adding 2019 figures to establish a baseline comparison.</p>
<pre class="r"><code>df_2019 &lt;- 
  read_xls(&quot;./data/2019/publishedweek522019.xls&quot;, 
           sheet = &quot;Weekly figures 2019&quot;, skip = 3)[c(4,5,9),-c(1,2)] %&gt;%
  mutate(value = c(&quot;total_deaths&quot;, &quot;total_deaths_ave5&quot;, &quot;respiratory_deaths&quot;)) %&gt;%
  mutate_at(vars(-value), as.numeric) %&gt;% 
  pivot_longer(names_to = &quot;week&quot;, 
               values_to = &quot;number_of_deaths&quot;, -value) %&gt;%
  mutate(year = &quot;2019&quot;)</code></pre>
</div>
<div id="flu-outbreak" class="section level4">
<h4>2015 flu outbreak</h4>
<p>2015 added for comparison with big flu outbreak.</p>
<pre class="r"><code>df_2015 &lt;-
  read_xls(&quot;./data/2015/publishedweek2015.xls&quot;, 
           sheet = &quot;Weekly Figures 2015&quot;, skip = 3)[c(4,5,9),-c(1)] %&gt;%
  mutate(value = c(&quot;total_deaths&quot;, &quot;total_deaths_ave5&quot;, &quot;respiratory_deaths&quot;)) %&gt;%
  mutate_at(vars(-value), as.integer) %&gt;% 
  pivot_longer(names_to = &quot;week&quot;, 
               values_to = &quot;number_of_deaths&quot;, -value) %&gt;%
  mutate(year = &quot;2015&quot;, 
         week = as.integer(week),
         week_ = ymd(&quot;2020-01-03&quot;) + 7 * (week-1))</code></pre>
</div>
<div id="current-data" class="section level4">
<h4>2020 current data</h4>
<p>This spreadsheet is the one that changes the most and includes increasingly more information.</p>
<pre class="r"><code>current_2020_spreadsheet &lt;- &quot;./data/2020/publishedweek282020.xlsx&quot;
sheets_2020 &lt;- readxl::excel_sheets(current_2020_spreadsheet)

df_2020_ &lt;- 
  read_xlsx(current_2020_spreadsheet, 
            sheet = sheets_2020[5], skip = 4)[c(4,6,13,14),-c(1,2)] %&gt;%
  mutate(value2 = c(&quot;total_deaths&quot;, &quot;total_deaths_ave5&quot;,
                   &quot;respiratory_deaths&quot;, &quot;covid_deaths&quot;),
         value = c(&quot;total_deaths&quot;, &quot;total_deaths_ave5&quot;,
                   &quot;respiratory_deaths&quot;, &quot;respiratory_deaths&quot;)) %&gt;%
  mutate_at(vars(-value, -value2), as.numeric) %&gt;% 
  pivot_longer(names_to = &quot;week&quot;, 
               values_to = &quot;number_of_deaths&quot;, 
               -c(value, value2))

df_2020 &lt;- 
  df_2020_ %&gt;% 
  select(-value2) %&gt;%
  mutate(year = &quot;2020&quot;) %&gt;%
  filter(!is.na(number_of_deaths))</code></pre>
<p>Here, I want to figure out the date of first COVID-19 related death in the UK.</p>
<pre class="r"><code># first COVID death
first_covid_week &lt;-
  df_2020_ %&gt;% 
  filter(value2 == &quot;covid_deaths&quot;, number_of_deaths &gt; 0) %&gt;% 
  arrange(week) %&gt;% 
  pull(week) %&gt;% 
  head(n = 1) %&gt;%
  as.numeric()</code></pre>
<p>Next, joining the 2020 data with 2019 baseline.</p>
<pre class="r"><code>df_all &lt;- 
  bind_rows(list(df_2019, df_2020)) %&gt;%
  mutate(week = as.numeric(week), 
         week_ = ymd(&quot;2020-01-03&quot;) + 7 * (week-1)) %&gt;%
  group_by(value, week, week_, year) %&gt;%
  summarise(number_of_deaths = sum(number_of_deaths)) %&gt;%
  ungroup()</code></pre>
</div>
</div>
<div id="covid-19-specific-datasets" class="section level3">
<h3>COVID-19 specific datasets</h3>
<p>One of the important information in understanding the pandemic is to see where the deaths are localized.</p>
<pre class="r"><code>place_of_death &lt;- 
  read_xlsx(current_2020_spreadsheet, 
            sheet = sheets_2020[grepl(&quot;Place&quot;, sheets_2020)], 
            skip = 4)[14:20,1:7] %&gt;%
  rename(place = 1) %&gt;%
  pivot_longer(names_to = &quot;country&quot;, 
               values_to = &quot;number_of_deaths&quot;,
               c(-place)) %&gt;%
  mutate(country = rep(c(rep(&quot;England and Wales&quot;, 2), rep(&quot;England&quot;, 2), rep(&quot;Wales&quot;, 2)), 7),
         cause = rep(rep(c(&quot;Total deaths&quot;, &quot;COVID-19 deaths&quot;), 3), 7)) %&gt;%
  mutate(number_of_deaths = as.numeric(number_of_deaths))</code></pre>
<p>The place of death dataset has information on place, country, number of death and whether the cause was related to COVID-19.</p>
<pre class="r"><code>place_of_death %&gt;%
  sample_n(5)</code></pre>
<pre><code>## # A tibble: 5 x 4
##   place                                   country number_of_deaths cause        
##   &lt;chr&gt;                                   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;        
## 1 All deaths                              Wales              20865 Total deaths 
## 2 Hospice                                 Wales                 15 COVID-19 dea…
## 3 Home                                    England             2231 COVID-19 dea…
## 4 Other communal establishment            Wales                 18 COVID-19 dea…
## 5 Hospital (acute or community, not psyc… Wales               1625 COVID-19 dea…</code></pre>
<pre class="r"><code>place_of_death_long &lt;- 
  read_xlsx(current_2020_spreadsheet, 
            sheet = sheets_2020[grepl(&quot;Place&quot;, sheets_2020)], 
            skip = 4)[4:9,] %&gt;%
  rename(place = 1) %&gt;%
  pivot_longer(names_to = &quot;cause&quot;,
               values_to = &quot;number_of_deaths&quot;,
               -place) %&gt;%
  mutate(cause = rep(c(&quot;Total deaths&quot;, &quot;COVID-19 deaths&quot;), n()/2),
         country = rep(c(rep(&quot;England and Wales&quot;, 2), 
                         rep(&quot;England&quot;, 2), 
                         rep(&quot;Wales&quot;, 2)), n()/6),
         week = rep(rep(11:(10 + n() / 36), each = 6), 6))</code></pre>
<pre class="r"><code>actual_vs_reported &lt;-
  read_xlsx(current_2020_spreadsheet, 
            sheet = sheets_2020[str_detect(sheets_2020, 
                                           regex(&quot;E&amp;W comparisons&quot;, 
                                                 ignore_case = TRUE))], skip = 4, 
            col_types = c(&quot;date&quot;, rep(&quot;numeric&quot;, 8)))[, 1:9] %&gt;%
  filter(!is.na(Date)) %&gt;%
  pivot_longer(names_to = &quot;source&quot;,
               values_to = &quot;number_of_deaths&quot;,
               -Date)</code></pre>
<pre class="r"><code>age_distribution &lt;- 
  read_xlsx(current_2020_spreadsheet, 
            sheet = sheets_2020[str_detect(sheets_2020, 
                                           regex(&quot;covid-19 .* occurrences&quot;, 
                                                 ignore_case = TRUE))], 
            skip = 4)[c(7:26,29:48,51:70), -1] %&gt;%
  mutate(sex = c(rep(&quot;Both&quot;, 20), rep(&quot;Males&quot;, 20), rep(&quot;Females&quot;, 20))) %&gt;%
  rename(age_group = `...2`) %&gt;%
  mutate_at(vars(-age_group, -sex), as.numeric) %&gt;%
  pivot_longer(names_to = &quot;week&quot;,
               values_to = &quot;number_of_deaths&quot;,
               cols = -c(age_group, sex)) %&gt;% 
  replace_na(list(number_of_deaths = 0)) %&gt;%
  group_by(sex, week) %&gt;%
  filter(sum(number_of_deaths, na.rm = TRUE) &gt; 0,
         !str_detect(week, &quot;[^0-9]+&quot;))</code></pre>
<pre class="r"><code>age_levels &lt;- 
  age_distribution$age_group %&gt;% 
  unique()

age_distribution &lt;-
  age_distribution %&gt;%
  ungroup() %&gt;%
  mutate(week = as.numeric(week), 
         week_ = lubridate::ymd(&quot;2020-01-03&quot;) + 7 * (week-1)) %&gt;%
  mutate(age_group = factor(age_group, levels = age_levels))

age_distribution_all &lt;- 
  read_xlsx(current_2020_spreadsheet, 
            sheet = sheets_2020[str_detect(sheets_2020, 
                                           regex(&quot;Weekly figures 2020&quot;, 
                                                 ignore_case = TRUE))], 
            skip = 4)[c(17:36,39:58,61:80), -1] %&gt;%
  mutate(sex = c(rep(&quot;Both&quot;, 20), rep(&quot;Males&quot;, 20), rep(&quot;Females&quot;, 20))) %&gt;%
  rename(age_group = 1) %&gt;%
  mutate_at(vars(-age_group, -sex), as.numeric) %&gt;%
  pivot_longer(names_to = &quot;week&quot;,
               values_to = &quot;number_of_deaths&quot;,
               cols = -c(age_group, sex)) %&gt;% 
  replace_na(list(number_of_deaths = 0)) %&gt;%
  group_by(sex, week) %&gt;%
  filter(sum(number_of_deaths, na.rm = TRUE) &gt; 0) %&gt;%
  ungroup() %&gt;%
  mutate(week = as.numeric(week), 
         week_ = lubridate::ymd(&quot;2020-01-03&quot;) + 7 * (week-1)) %&gt;%
  mutate(age_group = factor(age_group, levels = age_levels))</code></pre>
</div>
</div>
<div id="mortality-in-the-context-of-past-years" class="section level2">
<h2>Mortality in the context of past years</h2>
<div id="all-weekly-deaths-in-england-and-wales" class="section level3">
<h3>All weekly deaths in England and Wales</h3>
<p>It looks like the number of deaths came back to the 5-year average level. Really hopeful there will be no second wave.</p>
<pre class="r"><code>total &lt;- 
  df_all %&gt;%
  filter(value == &quot;total_deaths&quot;) %&gt;%
  ggplot(aes(x = week_, y = number_of_deaths, fill = year)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  geom_smooth(data = filter(df_all, 
                            value == &quot;total_deaths_ave5&quot; &amp; year == &quot;2019&quot;),
              color = &quot;grey60&quot;, se = FALSE) +
  facet_zoom(xy = week_ &lt; data_up_to + 1 &amp; week &gt;= first_covid_week,
             horizontal = FALSE, show.area = FALSE) +
  labs(y = &quot;Number of deaths&quot;, 
       title = &quot;Weekly total deaths  [grey = 5 year average]&quot;) + 
  theme(axis.title.x = element_blank()) +
  scale_fill_aaas()
total</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="respiratory-deaths" class="section level3">
<h3>Respiratory deaths</h3>
<p>COVID-19 deaths - those with COVID-19 mentioned on the death certificate and those without, result in higher than last year numbers of respiratory deaths. Thankfully, at this time it looks like the first wave has passed.</p>
<pre class="r"><code>upper_limit &lt;-
  df_all %&gt;%
  filter(value == &quot;respiratory_deaths&quot;) %&gt;%
  pull(number_of_deaths) %&gt;%
  max() + 100
respiratory &lt;-
  df_all %&gt;%
  filter(value == &quot;respiratory_deaths&quot;) %&gt;%
  ggplot(aes(x = week_, y = number_of_deaths, 
             group = year, color = year, shape = year)) +
  geom_point() +
  geom_smooth(se = FALSE, span = 0.3) +
  facet_zoom(xy = week_ &lt; data_up_to + 1 &amp; week &gt;= first_covid_week, 
             horizontal = FALSE, show.area = FALSE) +
  scale_color_aaas() +
  labs(y = &quot;Number of deaths&quot;, title = &quot;Weekly respiratory deaths&quot;) + 
  theme(axis.title.x = element_blank()) +
  coord_cartesian(ylim = c(0, upper_limit))
respiratory</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>However, the total number of COVID-19 deaths has already put the total number of respiratory deaths above the total 2019 respiratory deaths.</p>
<pre class="r"><code>cumulative_respiratory &lt;- 
  df_all %&gt;%
  arrange(week) %&gt;%
  group_by(value, year) %&gt;%
  mutate(cum = cumsum(number_of_deaths)) %&gt;%
  filter(value == &quot;respiratory_deaths&quot;) %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = week_, y = cum, color = year, shape = year)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  facet_zoom(xy = week_ &lt; data_up_to + 7 &amp; week &gt;= first_covid_week, 
             horizontal = FALSE, show.area = FALSE) +
  scale_color_aaas() +
  labs(y = &quot;Number of deaths&quot;, shape = &quot;Year&quot;,
       color = &quot;Year&quot;, title = &quot;Cumulative respiratory deaths&quot;) + 
  theme(axis.title.x = element_blank()) 
cumulative_respiratory</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>COVID-19 deaths increase exponentially, while the other respiratory deaths seem to be stable.</p>
<p>As per <a href="https://www.bbc.co.uk/news/health-52361519">BBC plot</a> I added the 2015 respiratory deaths, when the worst flu outbreak took place.</p>
<pre class="r"><code>df_2020_ %&gt;%
  mutate(year = &quot;2020&quot;,
         value2 = gsub(&quot;respiratory_deaths&quot;, &quot;other respiratory deaths&quot;, value2),
         value2 = str_replace(value2, &quot;covid_deaths&quot;, &quot;COVID-19 deaths&quot;),
         week = as.numeric(week), 
         week_ = lubridate::ymd(&quot;2020-01-03&quot;) + 7 * (week-1)) %&gt;%
  bind_rows((df_2015 %&gt;%
               mutate(value2 = ifelse(value == &quot;respiratory_deaths&quot;, 
                                      &quot;respiratory deaths in 2015&quot;, value)))) %&gt;%
  filter(value == &quot;respiratory_deaths&quot;) %&gt;%
  filter(!is.na(number_of_deaths)) %&gt;% # , 
         #week_ &lt; data_up_to + 1) %&gt;%
  ggplot(aes(x = week_, y = number_of_deaths, color = value2, shape = value2)) +
  geom_point() +
  geom_smooth(se = FALSE, span = 0.3) +
  scale_color_uchicago() +
  facet_zoom(xy = week_ &lt; data_up_to + 7 &amp; week &gt;= first_covid_week, 
             horizontal = FALSE, show.area = FALSE) +
  labs(y = &quot;Number of deaths&quot;, title = &quot;Weekly respiratory deaths&quot;,
       color = &quot;Cause of death&quot;, shape = &quot;Cause of death&quot;) + 
  theme(axis.title.x = element_blank(), legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>total / respiratory / cumulative_respiratory + plot_layout(guides = &quot;collect&quot;)
ggsave(&quot;./plots/up_to200327.png&quot;)</code></pre>
</div>
</div>
<div id="covid-19-specific-stats" class="section level2">
<h2>COVID-19 specific stats</h2>
<div id="excess-deaths---proxy-for-all-covid-19-related-deaths" class="section level3">
<h3>Excess deaths - proxy for all COVID-19 related deaths</h3>
<p>In this plot, I am looking at the difference in total number of deaths reported in the period since the first COVID-19 related death was reported and the 5-year average.</p>
<pre class="r"><code>col_scheme &lt;- pal_uchicago()(5)[c(1:2,5)]
names(col_scheme) &lt;- c(&quot;increasing phase&quot;, 
                       &quot;decreasing phase&quot;, 
                       &quot;deaths below average&quot;)

df_2020_excess &lt;-
  df_2020_ %&gt;% 
  filter(!is.na(number_of_deaths)) %&gt;% 
  group_by(week) %&gt;% 
  filter(any((value2 == &quot;covid_deaths&quot;) &amp; (number_of_deaths &gt; 0))) %&gt;%
  ungroup() %&gt;%
  filter(value2 %in% c(&quot;total_deaths&quot;, &quot;total_deaths_ave5&quot;)) %&gt;%
  select(-value) %&gt;%
  pivot_wider(names_from = value2, 
              values_from = number_of_deaths) %&gt;%
  mutate(difference = total_deaths - total_deaths_ave5,
         fract = difference / total_deaths_ave5,
         week_ = lubridate::ymd(&quot;2020-01-03&quot;) + 7 * (as.numeric(week) - 1),
         group = ifelse(difference &lt; 0,
                        &quot;deaths below average&quot;,
                        ifelse(difference &gt; lag(difference),
                               &quot;increasing phase&quot;,
                               &quot;decreasing phase&quot;)))
all_excess_deaths &lt;- 
  df_2020_excess %&gt;% 
  pull(difference) %&gt;% 
  sum()

all_deaths &lt;- 
  df_2020 %&gt;% 
  filter(value == &quot;total_deaths&quot;) %&gt;% 
  pull(number_of_deaths) %&gt;%
  sum()

fraction_excess &lt;- all_excess_deaths / all_deaths

excess_plt &lt;- 
  df_2020_excess %&gt;%
  ggplot(aes(week_, difference, fill = group)) +
  geom_bar(stat = &quot;identity&quot;) +
  scale_fill_manual(values = col_scheme) +
  theme(legend.title = element_blank(), axis.title.x = element_blank()) +
  labs(y = &quot;Number of deaths&quot;,
       title = &quot;COVID-19 excess deaths&quot;,
       subtitle = &quot;Difference in deaths over the 5-year average since first COVID-19 death reported&quot;)
excess_plt</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code>ggsave(plot = excess_plt, filename = &quot;featured.png&quot;, width = 7, height = 5)</code></pre>
<p>England &amp; Wales has moved <strong>past the peak</strong>. Up to Jul, 10 at least <strong>58 156 more people died</strong> when compared to the 5 year average. This means that <strong>16.5% of all deaths this year were directly, or indirectly caused by COVID-19</strong> (taking the excess mortality over the 5 year average as best proxy for number of deaths as a result of pandemic).</p>
</div>
<div id="place-of-death" class="section level3">
<h3>Place of death</h3>
<pre class="r"><code>fract_place_of_death &lt;- 
  place_of_death %&gt;% 
  filter(place != &quot;All deaths&quot;,
         country == &quot;England and Wales&quot;) %&gt;%
  mutate(place = gsub(&quot;Hospital \\(acute or community, not psychiatric\\)&quot;, 
                      &quot;Hospital&quot;, place),
         place = gsub(&quot;Other communal establishment&quot;, 
                      &quot;Other communal\nestablishment&quot;, place)) %&gt;%
  group_by(cause) %&gt;%
  mutate(fract = round(number_of_deaths / sum(number_of_deaths) * 100, 2))</code></pre>
<p>As of Jul, 10, majority of the deaths are reported in hospitals. However 37% of deaths occur outside of hospitals. Thankfully, all numbers seem to be going down, with hospital deaths dropping below the numbers from the beginning of the epidemic.</p>
<p>We saw increase in almost all places of death followed, thankfully by decrease.</p>
<p>My observations:</p>
<ol style="list-style-type: decimal">
<li>COVID-19 accounted only for some of the increase.</li>
</ol>
<p><em>My speculation:</em> Was that the case because no test was carried out? I find it unlikely, as the deaths reported to ONS don’t have to be verified by testing to be classified as COVID-19 related. It might be, for example, because <a href="https://www.washingtonpost.com/health/patients-with-heart-attacks-strokes-and-even-appendicitis-vanish-from-hospitals/2020/04/19/9ca3ef24-7eb4-11ea-9040-68981f488eed_story.html">people are scared to go to the hospitals.</a></p>
<p>Also, as have been already reported, the outbreak in care homes started later, hence we are seeing an increase in COVID-19 related deaths in those facilities.</p>
<ol start="2" style="list-style-type: decimal">
<li>We see that number of deaths with no mention of COVID-19 decreased in the hospitals and increased in recent weeks. I hypothesize it potentially can be explained by increase in deaths in other places, less road accidents and less scheduled medical interventions. And now, that lockdown has been lifted we potentially see the increase in accidents.</li>
</ol>
<p><strong>Note:</strong> <em>Many thanks to <a href="https://twitter.com/not_a_reptiloid">German</a> (and <a href="https://twitter.com/d_spiegel/status/1255148797333655552/photo/1">David Spiegelhalter plots</a>) for making me realise a mistake in the earlier iteration of the following plot!</em></p>
<pre class="r"><code>place_of_death_long %&gt;% 
  filter(country == &quot;England and Wales&quot;) %&gt;%
  mutate(place = gsub(&quot;Hospital \\(acute or community, not psychiatric\\)&quot;, 
                      &quot;Hospital&quot;, place),
         place = gsub(&quot;Other communal establishment&quot;, 
                      &quot;Other communal\nestablishment&quot;, place),
         week_ = ymd(&quot;2020-01-03&quot;) + 7 * (week-1),
         number_of_deaths = as.numeric(number_of_deaths)) %&gt;%
  pivot_wider(names_from = &quot;cause&quot;, values_from = number_of_deaths) %&gt;% 
  mutate(`No COVID-19 mentioned` = `Total deaths` - `COVID-19 deaths`) %&gt;%
  select(-`Total deaths`) %&gt;%
  pivot_longer(names_to = &quot;cause&quot;, values_to = &quot;number_of_deaths&quot;, 
               -c(place, country, week, week_)) %&gt;%
  group_by(place) %&gt;%
  mutate(max_deaths = max(number_of_deaths)) %&gt;%
  ungroup() %&gt;%
  mutate(place = reorder(place, -max_deaths)) %&gt;%
  filter(place %in% c(&quot;Care Home&quot;, &quot;Home&quot;, &quot;Hospital&quot;)) %&gt;%
  ggplot(aes(week_, number_of_deaths, fill = cause)) +
  geom_bar(stat = &quot;identity&quot;) +
  scale_fill_manual(values = pal_nejm()(6)[c(1,6)]) +
  facet_wrap(~place) +
  labs(title = paste0(&quot;Place of death [data up to &quot;, data_up_to, &quot;]&quot;),
       y = &quot;Number of reported deaths&quot;,
       fill = &quot;Place of death:&quot;) +
  theme(axis.title.x = element_blank(),
        text = element_text(size = 16))</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-22-1.png" width="960" /></p>
</div>
<div id="differences-between-the-reported-numbers" class="section level3">
<h3>Differences between the reported numbers</h3>
<p>The numbers reported by the government are lower than the actual number of deaths each day. Some of that comes from the delay in confirming the cause of death.</p>
<p>All the comparisons between previous years (in the earlier parts of this notebook) are done based on figures from <strong>ONS deaths by date of registration – registered by 10 Jul</strong> set for compatibility with earlier datasets.</p>
<pre class="r"><code>col_scheme &lt;- c(&quot;#E18727&quot;, &quot;#849460&quot;, &quot;#56603F&quot;, &quot;#20854E&quot;)
names(col_scheme) &lt;- unique(actual_vs_reported$source)[1:4]

label_postions &lt;- 
  actual_vs_reported %&gt;% 
  filter(source %in% names(col_scheme)) %&gt;%
  group_by(source) %&gt;%
  mutate(max = max(number_of_deaths)) %&gt;%
  arrange(Date) %&gt;%
  mutate(deaths_on_that_day = number_of_deaths - lag(number_of_deaths),
         max_on_day = max(deaths_on_that_day, na.rm = TRUE)) %&gt;%
  ungroup() %&gt;%
  filter(Date == lubridate::ymd(&quot;2020/03/6&quot;)) %&gt;%
  arrange(-max) %&gt;%
  mutate(fixed_position_cum = 1.15 * max(max) - 0.07 * max(max) * 1:length(col_scheme),
         fixed_position_daily = 1.15 * max(max_on_day) - 0.07 * max(max_on_day) * 1:length(col_scheme))

discrepancies &lt;-
  actual_vs_reported %&gt;%
  filter(source %in% names(col_scheme)) %&gt;%
  ggplot(aes(x = Date, y = number_of_deaths, color = source, shape = source)) +
  geom_smooth(se = FALSE) +
  geom_point(color = &quot;black&quot;) +
  geom_text(data = label_postions, size = 7, hjust = 0,
            aes(x = Date, y = fixed_position_cum, label = source)) + 
  geom_point(data = label_postions, color = &quot;black&quot;,
             aes(x = as_datetime(ymd(Date)-0.5), 
                 y = fixed_position_cum, shape = source)) +
  theme(legend.position = &quot;right&quot;) +
  #scale_color_nejm() +
  scale_color_manual(values = col_scheme) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))+
  theme(axis.title.x = element_blank(), text = element_text(size = 16),
        legend.position = &quot;none&quot;) +
  labs(color = &quot;Source&quot;, shape = &quot;Source&quot;, 
       y = &quot;Cummulative number of deaths&quot;,
       title = &quot;Delays in the reported numbers of COVID-19 deaths in England and Wales&quot;)

discrepancies</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-23-1.png" width="1248" /></p>
<pre class="r"><code># (discrepancies + theme(legend.position = &quot;none&quot;) + labs(title = &quot;[linear scale]&quot;)) / 
#   (discrepancies + scale_y_log10() + labs(title = &quot;[log scale]&quot;)) + 
#   plot_annotation(title =  &quot;Discrepancies between the reported numbers&quot;)</code></pre>
<p>Looking at the daily death rates it becomes clear that (1) data is very noisy and (2) there is a significant lag in the data.</p>
<p>We see that ONS data is especially influenced by the weekends and bank holidays. The reported numbers drop on the weekends (March 21 &amp; 22, 28 &amp; 29, April 4 &amp; 5, Easter weekend, and so on) and are higher in the next days.</p>
<pre class="r"><code>actual_vs_reported %&gt;%
  filter(source %in% names(col_scheme)) %&gt;%
  group_by(source) %&gt;%
  arrange(Date) %&gt;%
  mutate(deaths_on_that_day = number_of_deaths - lag(number_of_deaths)) %&gt;%
   ggplot(aes(x = Date, y = deaths_on_that_day, color = source, shape = source)) +
  geom_smooth(se = FALSE, span = 0.3) +
  geom_point(color = &quot;black&quot;) +
  geom_line(aes(group = source), alpha = 0.7, linetype = &quot;dotdash&quot;) +
  geom_text(data = label_postions, size = 7, hjust = 0,
            aes(x = Date, y = fixed_position_daily, label = source)) +
  geom_point(data = label_postions, color = &quot;black&quot;,
            aes(x = as_datetime(ymd(Date)-0.5), 
                y = fixed_position_daily, shape = source)) +
  scale_color_manual(values = col_scheme) +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))+
  labs(color = &quot;Source&quot;, shape = &quot;Source&quot;, 
       y = &quot;Number of deaths on the day&quot;,
       title = &quot;Discrepancies between the reported numbers of COVID-19 deaths in England and Wales&quot;) +
  theme(axis.title.x = element_blank(), legend.position = &quot;none&quot;,
        text = element_text(size = 16))</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-24-1.png" width="1248" /></p>
</div>
<div id="age-distribution" class="section level3">
<h3>Age distribution</h3>
<p>Looking at the deaths, Males are more affected than Females. How this plot looks like for cases? I.e. are men more susceptible?</p>
<p>I also wanted to compare the COVID-19 age and sex distribution with the UK population structure. I ended up comparing it to even more adequate data - to the deaths occurring in UK this year, before COVID-19. This will allow to put the age structure of COVID-19 into context.</p>
<pre class="r"><code>before_covid &lt;- ymd(&quot;2020-02-28&quot;)

age_distribution_bound &lt;-
  bind_rows(age_distribution_all %&gt;%
            mutate(type = &quot;Before COVID-19&quot;),
          age_distribution %&gt;%
            mutate(type = &quot;COVID-19&quot;)) %&gt;%
  filter(sex != &quot;Both&quot;) %&gt;%
  group_by(sex, age_group, type) %&gt;%
  summarise(number_of_deaths = sum(number_of_deaths)) %&gt;%
  group_by(type) %&gt;%
  mutate(all_deaths = sum(number_of_deaths)) %&gt;%
  group_by(sex, type, age_group) %&gt;%
  mutate(fraction_of_deaths = number_of_deaths/all_deaths * 100) %&gt;%
  ungroup()

age_distribution_bound %&gt;%
  mutate(age_group = factor(age_group, levels = rev(age_levels)),
         nod = ifelse(sex == &quot;Females&quot;, number_of_deaths, -number_of_deaths)) %&gt;%
  group_by(age_group) %&gt;%
  filter(sum(number_of_deaths) &gt; 0) %&gt;%
  ggplot(aes(x = age_group, y = nod, fill = sex)) +
  geom_bar(stat = &quot;identity&quot;) +
  scale_fill_npg() +
  facet_wrap(~type, scales = &quot;free_x&quot;) +
  # scale_y_continuous(breaks = break_axis,
  #                    labels = abs(break_axis)) +
  labs(x = &quot;Age groups&quot;,
       y = paste0(&quot;Number of deaths\n[Data up to:&quot;,
                  &quot; before COVID-19 -- &quot;, before_covid, 
                  &quot;; COVID-19 -- &quot;, data_up_to, 
                  &quot;]&quot;), 
       fill = &quot;Sex&quot;,
       title = ) +
  coord_flip() +
  theme(legend.position = &quot;bottom&quot;,
        text = element_text(size = 16))</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-26-1.png" width="960" /></p>
<p>This is even more visible when we compare the fraction of all deaths in each age group and with respect to sex.</p>
<pre class="r"><code>age_distribution_bound %&gt;% 
  group_by(age_group) %&gt;% 
  filter(sum(fraction_of_deaths) &gt; 5) %&gt;% 
  ungroup() %&gt;%
  ggplot(aes(age_group, fraction_of_deaths, fill = type)) + 
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) + 
  facet_wrap(~sex) +
  scale_fill_jama() +
  labs(title = &quot;Fraction of all deaths with respect to age group and sex&quot;,
       subtitle = &quot;age groups contirbuting to fewer than 5% filtered out&quot;) + 
  theme(axis.title = element_blank(), legend.title = element_blank(),
        text = element_text(size = 16))</code></pre>
<p><img src="/post/covid-19/notebook_files/figure-html/unnamed-chunk-27-1.png" width="960" /></p>
</div>
</div>
